# Тестовая задача
## Оглавление
- Установка и запуск
- Использование API
## Возможности
- Создание, чтение, обновление и удаление персональных данных (CRUD)
- Работа с Reindexer
## Установка и запуск
### Через докер
1. Клонируйте репозиторий `git clone https://github.com/wsb777/involta-test.git`
2. Настройте config.yml или .env по файлам-примерам
3. Откройте терминал в директории репозитория и введите `docker compose up -d`

Теперь сервис доступен по трем портам:
- 6534 - через него происходит общение между бд и сервисом
- 9088 - UI оболочка Reindexer
- 8080 - api сервиса

### Запуск без докера
1. Клонируйте репозиторий `git clone https://github.com/wsb777/involta-test.git`
2. Скачиваете зависимости через `go mod download` (для создания проекта использовалась версия golang 1.24.2)
3. Настройте config.yml или .env по файлам-примерам (предполагается, что Reindexer у Вас уже настроен и вы вводите его конфигурацию)
4. Следующим этапом запускаем проект через `go run /cmd/main.go` или компилируем его в файл командой `go build -o involta-test /cmd/main.go` и запускаем `./involta-test` (`source ./involta-test`)

Сервис доступен по порту 8080

## Использование API

- [GET] api/v1/health - для получения статуса о работе микросервиса
    
    Если микросервис запущен, то получаем статус 200

- [GET] api/v1/person/{id} - для получения пользователя по ID

    При успеном ответе получаем:
    `{"id":5,"firstName":"Ivan","secondName":"Ivanov","middleName":"Ivanovich","createAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201","updateAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201","documents":[{"id":1,"name":"Справка","createAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201"},{"id":2,"name":"Документ","createAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201"}]}`

- [POST] api/v1/person - для создания пользователя

    Пример данных для отправки:

    `{ "firstName":"Ivan", "secondName":"Ivanov","middleName":"Ivanovich", "documents":[{"id":1, "name":"Справка"},{"id":2, "name":"Документ"}]}`
    
    При успешном ответе получаем `success`

- [PUT] api/v1/person/{id} - для обновления пользователя

    Пример запроса, который нужно отправить:

    `{"firstName":"Ivan", "secondName":"Ivanov","middleName":"Ivanovich", "documents":[{"id":1, "name":"Справка"},{"id":2, "name":"Документ"}]}`

    При успешном ответе получаем `success`

- [DELETE] api/v1/person/{id} - для удаления пользователя

    При успешном ответе получаем `success`

- [GET] api/v1/persons?limit={number}?offset={number}?text={string} - Для получения пользователей по тексту, лимиту записей и количеству записей, которые нужно пропустить
    
    При успешном ответе получаем массив с персонами:
    `[{"id":5,"firstName":"Ivan","secondName":"Ivanov","middleName":"Ivanovich","createAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201","updateAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201","documents":[{"id":1,"name":"Справка","createAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201"},{"id":2,"name":"Документ","createAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201"}]},{"id":6,"firstName":"Ivan","secondName":"Ivanov","middleName":"Ivanovich","createAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201","updateAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201","documents":[{"id":1,"name":"Справка","createAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201"},{"id":2,"name":"Документ","createAt":"2025-09-12 14:43:14.4699895 +0300 MSK m=+191.572712201"}]}]`